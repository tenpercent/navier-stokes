\documentclass[12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{amsmath}

\title{Вычислительный практикум: Численное моделирование нестационарного течения вязкого газа
с использованием неявной разностной схемы}

\usepackage{geometry}
\geometry{left = 0.2cm}
\geometry{right = 0.2cm}
\geometry{top = 0.5cm}
\geometry{bottom = 1.cm}

\begin{document}
\maketitle
\section{Задание 1}
\subsection{Постановка задачи}
Рассмотрим систему уравнений, описывающую одномерное нестационарное движение вязкого баротропного газа:

$
\begin{cases}
	\frac{\partial\rho}{\partial t} + \frac{\partial\rho u}{\partial t} = 0{,}\\
	\rho\frac{\partial u}{\partial t} + \rho u \frac{\partial u}{\partial x} + \frac{dp}{dx} = \mu \frac{\partial^2 u}{\partial x^2}{,}\\
	\rho(x{,} \:0) = \rho_0 (x),\\
	u(x{,} \:0) = u_0 (x),\\
	u(0, \:t) = 0,\\
	u (X, \:t) = 0.
\end{cases}
$

$\Omega =\left[0{,} \:X\right] \times\left[0{,} \:T\right]$ ~--- область определения исходных функций,

$\mu$ ~--- вязкость газа, положительная константа,

$\rho (x{,} \:t)$ ~--- плотность газа, $(x{,} \:t) \in \Omega$,

 $u (x{,}\: t)$ ~--- скорость газа, $(x{,}\: t) \in \Omega$,
 
 $p(\rho)$ ~--- давление газа, эта функция считается известной. 
 
Введём новую функцию $g\left(x{,} t\right) = \ln p\left(\rho\left(x{,} t\right)\right)$. 
\subsection{Сведение задачи к решению системы линейных уравнений}
По сути, нам уже дана разностная схема, аппроксимирующая решение задачи, поэтому нам остается только выписать коэффициенты.

Обозначим $M + 1$ число пространственных узлов сетки на каждом шаге по времени. Нумеруем пространственные узлы от 0 до $M$.

Обозначим $G_m$, $V_m$ сеточные приближения функций $g(x, \tau)$, $u(x, \tau)$ при фиксированном времени $\tau$ в узле пространственной сетки с номером $m$.

Положим $$\tilde{\rho}  (x, t) = e^t(\cos\left(\frac{\pi x} {10}\right) + 1.5),$$ 
$$\tilde{u}  (x, t) = \cos(2\pi t)\sin\left(\pi\left(\frac{x}{10}\right)^2\right)$$

Обозначим $F_1(m)$, $F_2(m)$ результаты применения дифференциальных операторов в левой части системы уравнений к $\tilde{\rho}$ и $\tilde{u}$.

Из первого уравнения системы получаем $M - 1$ уравнение следующего вида ($1 \leq m \leq M - 1$):

$$
- \hat{G}_{m-1} \cdot \frac{V_m + V_{m-1}}{4h}
- \hat{V}_{m-1} \cdot \frac{1}{2h}
+ \hat{G}_{m}   \cdot \frac{1}{\tau}
+ \hat{G}_{m+1} \cdot \frac{V_{m-1} + V_m}{4h}
+ \hat{V}_{m+1} \cdot \frac{1}{2h} = $$
$$
= \frac{G_m}{\tau} +
  \frac{G_m \cdot \left( V_{m+1} - V_{m-1} \right)}{4h} +
  F_1(m)
$$

Одно уравнение следующего вида:

$$
  \hat{G}_0 \cdot \left( \frac{1}{\tau} - \frac{V_0}{2h} \right)
- \hat{V}_0 \cdot \frac{1}{h}
+ \hat{G}_1 \cdot \frac{V_1}{2h}
+ \hat{V}_1 \cdot \frac{1}{h} = $$
$$ = \frac{G_0}{\tau} +
  \frac{G_0 \cdot \left( V_1 - V_0 \right)}{2h} +
  \frac{G_2 V_2 - 2 G_1 V_1 + G_0 V_0 +
      \left( 2 - G_0 \right) \left( V_2 - 2 V_1 + V_0 \right)}{4h} +
  F_1(0)
$$

Одно уравнение следующего вида:

$$
- \hat{G}_{M-1} \cdot \frac{V_{M-1}}{2h}
- \hat{V}_{M-1} \cdot \frac{1}{h}
+ \hat{G}_{M}   \cdot \left( \frac{1}{\tau} + \frac{V_M}{2h} \right)
+ \hat{V}_{M}   \cdot \frac{1}{h} = $$
$$
= \frac{G_M}{\tau} +
  \frac{G_M \left( V_M - V_{M-1} \right) }{2h} +
  \frac{G_M V_M - 2 G_{M-1} V_{M-1} + G_{M-2} V_{M-2} +
      \left( 2 - G_M \right) \left( V_M - 2 V_{M-1} + V_{M-2} \right) }{4h} +
  F_1(M)
$$

Из второго уравнения системы получаем $M - 1$ уравнение следующего вида ($1 \leq m \leq M - 1$):

$$
- \hat{G}_{m-1} \cdot \frac{\tilde{p}'}{2h}
- \hat{V}_{m-1} \cdot \left( \frac{V_{m-1} + V_m}{6h} + \frac{4\tilde\mu}{3h^2} \right)
+ \hat{V}_{m}   \cdot \left( \frac{1}{\tau} + \frac{8\tilde\mu}{3h^2}  \right)
+ \hat{G}_{m+1} \cdot \frac{\tilde{p}'}{2h} =
$$
$$
= \frac{V_m}{\tau} 
- \frac{4}{3h^2}\left(\tilde\mu - \mu e^{-G_m}\right)\left(V_{m+1} - 2V_{m} + V_{m-1}\right)
+ F_2(m)
$$

Из граничных условий на $u(x, t)$ получаем еще 2 уравнения:

$$
\hat{V}_{0} = 0
$$
$$
\hat{V}_{M} = 0
$$

Таким образом, у нас теперь есть матрица системы с $2M + 2$ уравнениями и таким же количеством неизвестных.

\subsection{Организация хранения результатов вычислений.}

Матрица системы хранится в формате MSR (Modified Compressed Sparse Row Format): 2 массива $I$ и $J$ размера $diag + nzcount + 1$, где $diag$ ~--- размер диагонали матрицы, $nzcount$ ~--- число ненулевых недиагональных элементов матрицы $A$. Массивы $I$, $J$ описывается так:

$I\left[k\right] = a_{kk}$,  $0 \leq k < diag$,

$I\left[k\right]$,  $diag + 1 \leq k < diag + nzcount + 1$ ~--- остальные ненулевые элементы матрицы $A$, выписанные по рядам,

$J\left[k\right]$,  $\leq k < diag$ ~--- индексы начал рядов матрицы $A$ в массиве $I$,

$J[diag] = diag + nzcount + 1$,

$J\left[k\right]$,  $diag + 1 \leq k < diag + nzcount + 1$ ~--- номер столбца матрицы $A$, в котором лежит элемент $I[k]$.

Кроме того, постоянно храним массивы $V$ и $G$.

Таким образом, затраты по памяти примерно равны $M + M + 2(2M + 4\cdot 2M) = 22M$, где $M$ ~--- число узлов пространственной сетки.

\subsection{Результаты}

В этом задании не нужно реализовывать вычислительных алгоритмов, поэтому возьмем их реализацию из пакета LASPack. И сразу перейдем к результатам.
\\

Использьзуем метод CGN с предобуславливателем Якоби:

\begin{center}
\begin{tabular}{lllllllll}
\# & t & $\omega$ & $\tau$ & $h$ & $\|v - u\|_{C_h}$ & $\|v - u\|_{L_{2,h}}$ & $\|g - \ln\rho\|_{C_h}$ & $\|g - \ln\rho\|_{L_{2,h}}$ \\
1 &      0.049 s &      1.000 &      2.040816e-02 &      2.040816e-01 &      9.475005e-03 &      4.438946e-03 &      1.324571e-02 &      5.359640e-03\\
2&      0.057 s&      1.000&      1.010101e-02&      2.040816e-01&      7.794967e-03&      3.573753e-03&      6.815774e-03&      2.793311e-03\\
3&      0.085 s&      1.000&      5.025126e-03&      2.040816e-01&      6.461721e-03&      2.935508e-03&      3.691676e-03&      1.592340e-03\\
4&      0.101 s&      1.000&      2.506266e-03&      2.040816e-01&      5.703862e-03&      2.575507e-03&      2.173406e-03&      1.067151e-03\\
5&      0.130 s&      1.000&      2.040816e-02&      1.010101e-01&      1.095026e-02&      5.092533e-03&      1.444278e-02&      5.693338e-03\\
6&      0.154 s&      1.000&      1.010101e-02&      1.010101e-01&      9.283938e-03&      4.230940e-03&      7.985902e-03&      3.143612e-03\\
7&      0.168 s&      1.000&      5.025126e-03&      1.010101e-01&      7.986515e-03&      3.571348e-03&      4.841548e-03&      1.937372e-03\\
8&      0.223 s&      1.000&      2.506266e-03&      1.010101e-01&      7.218529e-03&      3.188552e-03&      3.301676e-03&      1.383362e-03\\
9&      0.638 s&      1.000&      2.040816e-02&      5.025126e-02&      1.130436e-02&      5.266042e-03&      1.474223e-02&      5.756283e-03\\
10&      0.699 s&      1.000&      1.010101e-02&      5.025126e-02&      9.647841e-03&      4.405879e-03&      8.267401e-03&      3.218775e-03\\
11&      0.685 s&      1.000&      5.025126e-03&      5.025126e-02&      8.349949e-03&      3.742951e-03&      5.119970e-03&      2.016535e-03\\
12&      0.741 s&      1.000&      2.506266e-03&      5.025126e-02&      7.586114e-03&      3.356709e-03&      3.575871e-03&      1.460766e-03\\
13&      1.874 s&      1.000&      2.040816e-02&      2.506266e-02&      1.178499e-02&      5.490863e-03&      1.470755e-02&      5.694785e-03\\
14&      3.408 s&      1.000&      1.010101e-02&      2.506266e-02&      9.740925e-03&      4.454146e-03&      8.338474e-03&      3.231733e-03\\
15&      4.204 s&      1.000&      5.025126e-03&      2.506266e-02&      8.442187e-03&      3.788393e-03&      5.190255e-03&      2.033207e-03\\
16&      3.783 s&      1.000&      2.506266e-03&      2.506266e-02&      7.676740e-03&      3.401158e-03&      3.644282e-03&      1.478209e-03\\
\end{tabular}
\end{center}

Использьзуем метод BiCGStab с предобуславливателем Якоби:

\begin{center}
\begin{tabular}{lllllllll}
\# & t & $\omega$ & $\tau$ & $h$ & $\|v - u\|_{C_h}$ & $\|v - u\|_{L_{2,h}}$ & $\|g - \ln\rho\|_{C_h}$ & $\|g - \ln\rho\|_{L_{2,h}}$ \\
1&      0.015 s&      1.000&      2.040816e-02&      2.040816e-01&      9.475017e-03&      4.438924e-03&      1.324571e-02&      5.359638e-03\\
2&      0.020 s&      1.000&      1.010101e-02&      2.040816e-01&      7.794913e-03&      3.573694e-03&      6.815842e-03&      2.793313e-03\\
3&      0.037 s&      1.000&      5.025126e-03&      2.040816e-01&      6.461433e-03&      2.935347e-03&      3.692013e-03&      1.592433e-03\\
4&      0.059 s&      1.000&      2.506266e-03&      2.040816e-01&      5.703442e-03&      2.575325e-03&      2.173768e-03&      1.067153e-03\\
5&      0.037 s&      1.000&      2.040816e-02&      1.010101e-01&      1.095034e-02&      5.092540e-03&      1.444274e-02&      5.693334e-03\\
6&      0.046 s&      1.000&      1.010101e-02&      1.010101e-01&      9.283868e-03&      4.230860e-03&      7.985958e-03&      3.143614e-03\\
7&      0.093 s&      1.000&      5.025126e-03&      1.010101e-01&      7.986288e-03&      3.571194e-03&      4.841664e-03&      1.937399e-03\\
8&      0.106 s&      1.000&      2.506266e-03&      1.010101e-01&      7.216945e-03&      3.187820e-03&      3.302415e-03&      1.383654e-03\\
9&      0.090 s&      1.000&      2.040816e-02&      5.025126e-02&      1.130446e-02&      5.266070e-03&      1.474218e-02&      5.756281e-03\\
10&      0.106 s&      1.000&      1.010101e-02&      5.025126e-02&      9.647815e-03&      4.405830e-03&      8.267370e-03&      3.218769e-03\\
11&      0.149 s&      1.000&      5.025126e-03&      5.025126e-02&      8.349795e-03&      3.742842e-03&      5.120145e-03&      2.016539e-03\\
12&      0.212 s&      1.000&      2.506266e-03&      5.025126e-02&      7.585744e-03&      3.356520e-03&      3.575990e-03&      1.460783e-03\\
13&      0.357 s&      1.000&      2.040816e-02&      2.506266e-02&      1.139142e-02&      5.312752e-03&      1.481226e-02&      5.763000e-03\\
14&      0.353 s&      1.000&      1.010101e-02&      2.506266e-02&      9.737906e-03&      4.452418e-03&      8.339346e-03&      3.232400e-03\\
15&      0.385 s&      1.000&      5.025126e-03&      2.506266e-02&      8.442045e-03&      3.788291e-03&      5.190352e-03&      2.033195e-03\\
16&      0.554 s&      1.000&      2.506266e-03&      2.506266e-02&      7.676539e-03&      3.401051e-03&      3.644429e-03&      1.478231e-03\\
\end{tabular}
\end{center}

Использьзуем метод CGN без предобуславливателя:

\begin{center}
\begin{tabular}{lllllllll}
\# & t & $\omega$ & $\tau$ & $h$ & $\|v - u\|_{C_h}$ & $\|v - u\|_{L_{2,h}}$ & $\|g - \ln\rho\|_{C_h}$ & $\|g - \ln\rho\|_{L_{2,h}}$ \\
1&      0.048 s&      1.000&      2.040816e-02&      2.040816e-01&      9.475040e-03&      4.438922e-03&      1.324584e-02&      5.359664e-03\\
2&      0.068 s&      1.000&      1.010101e-02&      2.040816e-01&      7.795248e-03&      3.573817e-03&      6.815638e-03&      2.793299e-03\\
3&      0.095 s&      1.000&      5.025126e-03&      2.040816e-01&      6.461329e-03&      2.935350e-03&      3.692068e-03&      1.592418e-03\\
4&      0.110 s&      1.000&      2.506266e-03&      2.040816e-01&      5.703798e-03&      2.575313e-03&      2.174279e-03&      1.067357e-03\\
5&      0.133 s&      1.000&      2.040816e-02&      1.010101e-01&      1.095043e-02&      5.092460e-03&      1.444293e-02&      5.693376e-03\\
6&      0.189 s&      1.000&      1.010101e-02&      1.010101e-01&      9.284200e-03&      4.231051e-03&      7.985820e-03&      3.143596e-03\\
7&      0.242 s&      1.000&      5.025126e-03&      1.010101e-01&      7.986157e-03&      3.571094e-03&      4.842133e-03&      1.937545e-03\\
8&      0.301 s&      1.000&      2.506266e-03&      1.010101e-01&      7.218806e-03&      3.188502e-03&      3.301169e-03&      1.383549e-03\\
9&      0.686 s&      1.000&      2.040816e-02&      5.025126e-02&      1.131353e-02&      5.271222e-03&      1.474997e-02&      5.757415e-03\\
10&      0.896 s&      1.000&      1.010101e-02&      5.025126e-02&      9.648092e-03&      4.406003e-03&      8.267373e-03&      3.218756e-03\\
11&      1.056 s&      1.000&      5.025126e-03&      5.025126e-02&      8.349789e-03&      3.742744e-03&      5.120625e-03&      2.016751e-03\\
12&      1.181 s&      1.000&      2.506266e-03&      5.025126e-02&      7.586791e-03&      3.356913e-03&      3.576301e-03&      1.461066e-03\\
13&      1.392 s&      1.000&      2.040816e-02&      2.506266e-02&      2.159911e-01&      1.051111e-01&      6.871240e-01&      4.640578e-02\\
14&      2.849 s&      1.000&      1.010101e-02&      2.506266e-02&      1.518792e-01&      7.180803e-02&      5.301931e-01&      3.655033e-02\\
15&      5.603 s&      1.000&      5.025126e-03&      2.506266e-02&      2.086889e-02&      9.316013e-03&      4.106406e-02&      4.105134e-03\\
16&      7.304 s&      1.000&      2.506266e-03&      2.506266e-02&      7.678219e-03&      3.401757e-03&      3.645935e-03&      1.478759e-03\\
\end{tabular}
\end{center}

Использьзуем метод BiCGStab без предобуславливателя:

\begin{center}
\begin{tabular}{lllllllll}
\# & t & $\omega$ & $\tau$ & $h$ & $\|v - u\|_{C_h}$ & $\|v - u\|_{L_{2,h}}$ & $\|g - \ln\rho\|_{C_h}$ & $\|g - \ln\rho\|_{L_{2,h}}$ \\

1&      0.016 s&      1.000&      2.040816e-02&      2.040816e-01&      9.474993e-03&      4.438920e-03&      1.324567e-02&      5.359633e-03\\
2&      0.024 s&      1.000&      1.010101e-02&      2.040816e-01&      7.794873e-03&      3.573688e-03&      6.815937e-03&      2.793352e-03\\
3&      0.037 s&      1.000&      5.025126e-03&      2.040816e-01&      6.461496e-03&      2.935348e-03&      3.691855e-03&      1.592353e-03\\
4&      0.059 s&      1.000&      2.506266e-03&      2.040816e-01&      5.703579e-03&      2.575382e-03&      2.173851e-03&      1.067197e-03\\
5&      0.028 s&      1.000&      2.040816e-02&      1.010101e-01&      1.095031e-02&      5.092530e-03&      1.444271e-02&      5.693339e-03\\
6&      0.037 s&      1.000&      1.010101e-02&      1.010101e-01&      9.283795e-03&      4.230831e-03&      7.985852e-03&      3.143583e-03\\
7&      0.058 s&      1.000&      5.025126e-03&      1.010101e-01&      7.986290e-03&      3.571200e-03&      4.841600e-03&      1.937393e-03\\
8&      0.092 s&      1.000&      2.506266e-03&      1.010101e-01&      7.218262e-03&      3.188395e-03&      3.301349e-03&      1.383374e-03\\
9&      0.086 s&      1.000&      2.040816e-02&      5.025126e-02&      1.130444e-02&      5.266071e-03&      1.474212e-02&      5.756287e-03\\
10&      0.115 s&      1.000&      1.010101e-02&      5.025126e-02&      9.647530e-03&      4.405668e-03&      8.267395e-03&      3.218740e-03\\
11&      0.161 s&      1.000&      5.025126e-03&      5.025126e-02&      8.350122e-03&      3.743024e-03&      5.119744e-03&      2.016518e-03\\
12&      0.205 s&      1.000&      2.506266e-03&      5.025126e-02&      7.585854e-03&      3.356555e-03&      3.575837e-03&      1.460760e-03\\
13&      0.233 s&      1.000&      2.040816e-02&      2.506266e-02&      1.139138e-02&      5.312743e-03&      1.481219e-02&      5.762996e-03\\
14&      0.303 s&      1.000&      1.010101e-02&      2.506266e-02&      9.737688e-03&      4.452300e-03&      8.339383e-03&      3.232391e-03\\
15&      0.449 s&      1.000&      5.025126e-03&      2.506266e-02&      8.441620e-03&      3.788010e-03&      5.190238e-03&      2.033082e-03\\
16&      0.536 s&      1.000&      2.506266e-03&      2.506266e-02&      7.677611e-03&      3.401639e-03&      3.643423e-03&      1.478215e-03\\

\end{tabular}
\end{center}

\section{Задание 2.}

Это задание отличается от первого тем, что необходимо реализовать самостоятельно итерационый алгоритм, решающий систему линейных уравнений.

\subsection{Теория.}

Реализуем стабилизированный метод бисопряжённых
градиентов с предобуславливателем. 

Пусть $A$ --- матрица системы, $\mathbf b$ --- правая часть, $\mathbf x$ ---
начальное приближение системы, $K$ --- матрица предобуславливателя.

Начальные значения переменных:

\begin{enumerate}
\item $\mathbf v = \mathbf 0$,
\item $\mathbf p = \mathbf 0$,
\item $\mathbf r = \mathbf b - A \mathbf x$,
\item $\mathbf{\hat r} = \mathbf b - A \mathbf x$.
\end{enumerate}

Каждая итерация состоит из следующих шагов:
\begin{enumerate}
\item $\rho_\text{prev} = \rho$,
\item $\rho = (\mathbf{\hat r}, \mathbf r)$,
\item $\beta = (\rho \cdot \alpha) / (\rho_\text{prev} \cdot \omega)$,
\item $\mathbf p = \mathbf r + \beta \cdot (\mathbf p - \omega \mathbf v)$,
\item $\mathbf y = K \mathbf p$,
\item $\mathbf v = A \mathbf y$,
\item $\alpha = \rho / (\mathbf{\hat r}, \mathbf v)$,
\item $\mathbf s = \mathbf r - \alpha \mathbf v$,
\item $\mathbf z = K \mathbf s$,
\item $\mathbf t = A \mathbf z$,
\item $\omega = (\mathbf t, \mathbf s) / (\mathbf t, \mathbf t)$,
\item $\mathbf x = \mathbf x + \alpha \mathbf y + \omega \mathbf z$,
\item $d = \left\|A \mathbf x - \mathbf b\right\|$,
\item $\mathbf r = \mathbf s - \omega \mathbf t$.
\end{enumerate}
Алгоритм заканчивается, когда $d$ будет меньше требуемой точности, или будет
достигнуто максимальное число итераций.

В качестве предобуславливателя используется предобуславливатель Якоби
с матрицей $K = \omega_\text{prec} \cdot D^{-1}(A)$.

\subsection{Результаты.}

В этом задании будем запускать программу с различными значениями константы релаксации пред\-обуслав\-ливателя $\omega$.

\begin{center}
\begin{tabular}{lllllllll}
\# & t & $\omega$ & $\tau$ & $h$ & $\|v - u\|_{C_h}$ & $\|v - u\|_{L_{2,h}}$ & $\|g - \ln\rho\|_{C_h}$ & $\|g - \ln\rho\|_{L_{2,h}}$ \\

1&      0.007 s&      1.000&      2.040816e-02&      2.040816e-01&      1.143788e-02&      5.821671e-03&      1.016702e-02&      3.950936e-03\\
2&      0.009 s&      1.000&      1.010101e-02&      2.040816e-01&      5.333344e-03&      2.761070e-03&      4.079389e-03&      1.645929e-03\\
3&      0.014 s&      1.000&      5.025126e-03&      2.040816e-01&      1.788999e-03&      1.040214e-03&      1.133197e-03&      5.473054e-04\\
4&      0.029 s&      1.000&      2.506266e-03&      2.040816e-01&      7.426616e-04&      4.877758e-04&      3.146549e-04&      1.919942e-04\\
5&      0.015 s&      1.000&      2.040816e-02&      1.010101e-01&      1.307905e-02&      6.611183e-03&      1.151447e-02&      4.356692e-03\\
6&      0.023 s&      1.000&      1.010101e-02&      1.010101e-01&      6.973412e-03&      3.521696e-03&      5.411848e-03&      2.063868e-03\\
7&      0.042 s&      1.000&      5.025126e-03&      1.010101e-01&      3.400280e-03&      1.719354e-03&      2.458380e-03&      9.513754e-04\\
8&      0.067 s&      1.000&      2.506266e-03&      1.010101e-01&      1.480623e-03&      7.594888e-04&      1.006883e-03&      4.049073e-04\\
9&      0.052 s&      1.000&      2.040816e-02&      5.025126e-02&      1.349230e-02&      6.816782e-03&      1.184267e-02&      4.438594e-03\\
10&      0.051 s&      1.000&      1.010101e-02&      5.025126e-02&      7.379377e-03&      3.720840e-03&      5.735644e-03&      2.157804e-03\\
11&      0.077 s&      1.000&      5.025126e-03&      5.025126e-02&      3.795799e-03&      1.912694e-03&      2.780234e-03&      1.050495e-03\\
12&      0.117 s&      1.000&      2.506266e-03&      5.025126e-02&      1.875565e-03&      9.455836e-04&      1.328508e-03&      5.053373e-04\\
13&      0.975 s&      1.000&      2.040816e-02&      2.506266e-02&      1.224647e-16&      nan&      nan&      nan\\
14&      0.176 s&      1.000&      1.010101e-02&      2.506266e-02&      7.478029e-03&      3.772911e-03&      5.815960e-03&      2.177077e-03\\
15&      0.194 s&      1.000&      5.025126e-03&      2.506266e-02&      3.895374e-03&      1.962594e-03&      2.859948e-03&      1.073059e-03\\
16&      0.288 s&      1.000&      2.506266e-03&      2.506266e-02&      1.974647e-03&      9.941277e-04&      1.407908e-03&      5.294525e-04\\
\end{tabular}
\end{center}
\begin{center}
\begin{tabular}{lllllllll}
\# & t & $\omega$ & $\tau$ & $h$ & $\|v - u\|_{C_h}$ & $\|v - u\|_{L_{2,h}}$ & $\|g - \ln\rho\|_{C_h}$ & $\|g - \ln\rho\|_{L_{2,h}}$ \\

1&      0.005 s&      1.500&      2.040816e-02&      2.040816e-01&      1.143788e-02&      5.821671e-03&      1.016702e-02&      3.950936e-03\\
2&      0.009 s&      1.500&      1.010101e-02&      2.040816e-01&      5.333344e-03&      2.761070e-03&      4.079389e-03&      1.645929e-03\\
3&      0.016 s&      1.500&      5.025126e-03&      2.040816e-01&      1.788999e-03&      1.040214e-03&      1.133197e-03&      5.473054e-04\\
4&      0.029 s&      1.500&      2.506266e-03&      2.040816e-01&      7.426616e-04&      4.877758e-04&      3.146549e-04&      1.919942e-04\\
5&      0.013 s&      1.500&      2.040816e-02&      1.010101e-01&      1.307905e-02&      6.611183e-03&      1.151447e-02&      4.356692e-03\\
6&      0.023 s&      1.500&      1.010101e-02&      1.010101e-01&      6.973412e-03&      3.521696e-03&      5.411848e-03&      2.063868e-03\\
7&      0.034 s&      1.500&      5.025126e-03&      1.010101e-01&      3.400280e-03&      1.719354e-03&      2.458380e-03&      9.513754e-04\\
8&      0.064 s&      1.500&      2.506266e-03&      1.010101e-01&      1.480623e-03&      7.594888e-04&      1.006883e-03&      4.049073e-04\\
9&      0.050 s&      1.500&      2.040816e-02&      5.025126e-02&      1.349230e-02&      6.816782e-03&      1.184267e-02&      4.438594e-03\\
10&      0.048 s&      1.500&      1.010101e-02&      5.025126e-02&      7.379377e-03&      3.720840e-03&      5.735644e-03&      2.157804e-03\\
11&      0.080 s&      1.500&      5.025126e-03&      5.025126e-02&      3.795799e-03&      1.912694e-03&      2.780234e-03&      1.050495e-03\\
12&      0.113 s&      1.500&      2.506266e-03&      5.025126e-02&      1.875565e-03&      9.455836e-04&      1.328508e-03&      5.053373e-04\\
13&      0.467 s&      1.500&      2.040816e-02&      2.506266e-02&      1.359389e-02&      6.872219e-03&      1.192408e-02&      4.450914e-03\\
14&      0.175 s&      1.500&      1.010101e-02&      2.506266e-02&      7.478029e-03&      3.772911e-03&      5.815960e-03&      2.177077e-03\\
15&      0.181 s&      1.500&      5.025126e-03&      2.506266e-02&      3.895374e-03&      1.962594e-03&      2.859948e-03&      1.073059e-03\\
16&      0.281 s&      1.500&      2.506266e-03&      2.506266e-02&      1.974647e-03&      9.941277e-04&      1.407908e-03&      5.294525e-04\\
\end{tabular}
\end{center}
\begin{center}
\begin{tabular}{lllllllll}
\# & t & $\omega$ & $\tau$ & $h$ & $\|v - u\|_{C_h}$ & $\|v - u\|_{L_{2,h}}$ & $\|g - \ln\rho\|_{C_h}$ & $\|g - \ln\rho\|_{L_{2,h}}$ \\

1&      0.006 s&      1.550&      2.040816e-02&      2.040816e-01&      1.143788e-02&      5.821671e-03&      1.016702e-02&      3.950936e-03\\
2&      0.010 s&      1.550&      1.010101e-02&      2.040816e-01&      5.333344e-03&      2.761070e-03&      4.079389e-03&      1.645929e-03\\
3&      0.018 s&      1.550&      5.025126e-03&      2.040816e-01&      1.788999e-03&      1.040214e-03&      1.133197e-03&      5.473054e-04\\
4&      0.028 s&      1.550&      2.506266e-03&      2.040816e-01&      7.426616e-04&      4.877758e-04&      3.146549e-04&      1.919942e-04\\
5&      0.013 s&      1.550&      2.040816e-02&      1.010101e-01&      1.307905e-02&      6.611183e-03&      1.151447e-02&      4.356692e-03\\
6&      0.023 s&      1.550&      1.010101e-02&      1.010101e-01&      6.973412e-03&      3.521696e-03&      5.411848e-03&      2.063868e-03\\
7&      0.032 s&      1.550&      5.025126e-03&      1.010101e-01&      3.400280e-03&      1.719354e-03&      2.458380e-03&      9.513754e-04\\
8&      0.063 s&      1.550&      2.506266e-03&      1.010101e-01&      1.480623e-03&      7.594888e-04&      1.006883e-03&      4.049073e-04\\
9&      0.050 s&      1.550&      2.040816e-02&      5.025126e-02&      1.349230e-02&      6.816782e-03&      1.184267e-02&      4.438594e-03\\
10&      0.051 s&      1.550&      1.010101e-02&      5.025126e-02&      7.379377e-03&      3.720840e-03&      5.735644e-03&      2.157804e-03\\
11&      0.078 s&      1.550&      5.025126e-03&      5.025126e-02&      3.795799e-03&      1.912694e-03&      2.780234e-03&      1.050495e-03\\
12&      0.120 s&      1.550&      2.506266e-03&      5.025126e-02&      1.875565e-03&      9.455836e-04&      1.328508e-03&      5.053373e-04\\
13&      0.426 s&      1.550&      2.040816e-02&      2.506266e-02&      1.359389e-02&      6.872216e-03&      1.192407e-02&      4.450919e-03\\
14&      0.171 s&      1.550&      1.010101e-02&      2.506266e-02&      7.478029e-03&      3.772911e-03&      5.815960e-03&      2.177077e-03\\
15&      0.185 s&      1.550&      5.025126e-03&      2.506266e-02&      3.895374e-03&      1.962594e-03&      2.859948e-03&      1.073059e-03\\
16&      0.288 s&      1.550&      2.506266e-03&      2.506266e-02&      1.974647e-03&      9.941277e-04&      1.407908e-03&      5.294525e-04\\
\end{tabular}
\end{center}
\begin{center}
\begin{tabular}{lllllllll}
\# & t & $\omega$ & $\tau$ & $h$ & $\|v - u\|_{C_h}$ & $\|v - u\|_{L_{2,h}}$ & $\|g - \ln\rho\|_{C_h}$ & $\|g - \ln\rho\|_{L_{2,h}}$ \\

1&      0.006 s&      1.600&      2.040816e-02&      2.040816e-01&      1.143788e-02&      5.821671e-03&      1.016702e-02&      3.950936e-03\\
2&      0.010 s&      1.600&      1.010101e-02&      2.040816e-01&      5.333344e-03&      2.761070e-03&      4.079389e-03&      1.645929e-03\\
3&      0.017 s&      1.600&      5.025126e-03&      2.040816e-01&      1.788999e-03&      1.040214e-03&      1.133197e-03&      5.473054e-04\\
4&      0.032 s&      1.600&      2.506266e-03&      2.040816e-01&      7.426616e-04&      4.877758e-04&      3.146549e-04&      1.919942e-04\\
5&      0.014 s&      1.600&      2.040816e-02&      1.010101e-01&      1.307905e-02&      6.611183e-03&      1.151447e-02&      4.356692e-03\\
6&      0.024 s&      1.600&      1.010101e-02&      1.010101e-01&      6.973412e-03&      3.521696e-03&      5.411848e-03&      2.063868e-03\\
7&      0.038 s&      1.600&      5.025126e-03&      1.010101e-01&      3.400280e-03&      1.719354e-03&      2.458380e-03&      9.513754e-04\\
8&      0.062 s&      1.600&      2.506266e-03&      1.010101e-01&      1.480623e-03&      7.594888e-04&      1.006883e-03&      4.049073e-04\\
9&      0.052 s&      1.600&      2.040816e-02&      5.025126e-02&      1.349230e-02&      6.816782e-03&      1.184267e-02&      4.438594e-03\\
10&      0.050 s&      1.600&      1.010101e-02&      5.025126e-02&      7.379377e-03&      3.720840e-03&      5.735644e-03&      2.157804e-03\\
11&      0.075 s&      1.600&      5.025126e-03&      5.025126e-02&      3.795799e-03&      1.912694e-03&      2.780234e-03&      1.050495e-03\\
12&      0.113 s&      1.600&      2.506266e-03&      5.025126e-02&      1.875565e-03&      9.455836e-04&      1.328508e-03&      5.053373e-04\\
13&      0.437 s&      1.600&      2.040816e-02&      2.506266e-02&      1.359389e-02&      6.872216e-03&      1.192407e-02&      4.450919e-03\\
14&      0.176 s&      1.600&      1.010101e-02&      2.506266e-02&      7.478029e-03&      3.772911e-03&      5.815960e-03&      2.177077e-03\\
15&      0.176 s&      1.600&      5.025126e-03&      2.506266e-02&      3.895374e-03&      1.962594e-03&      2.859948e-03&      1.073059e-03\\
16&      0.269 s&      1.600&      2.506266e-03&      2.506266e-02&      1.974647e-03&      9.941277e-04&      1.407908e-03&      5.294525e-04\\
\end{tabular}
\end{center}
\begin{center}
\begin{tabular}{lllllllll}
\# & t & $\omega$ & $\tau$ & $h$ & $\|v - u\|_{C_h}$ & $\|v - u\|_{L_{2,h}}$ & $\|g - \ln\rho\|_{C_h}$ & $\|g - \ln\rho\|_{L_{2,h}}$ \\

1&      0.006 s&      2.000&      2.040816e-02&      2.040816e-01&      1.143788e-02&      5.821671e-03&      1.016702e-02&      3.950936e-03\\
2&      0.010 s&      2.000&      1.010101e-02&      2.040816e-01&      5.333344e-03&      2.761070e-03&      4.079389e-03&      1.645929e-03\\
3&      0.016 s&      2.000&      5.025126e-03&      2.040816e-01&      1.788999e-03&      1.040214e-03&      1.133197e-03&      5.473054e-04\\
4&      0.031 s&      2.000&      2.506266e-03&      2.040816e-01&      7.426616e-04&      4.877758e-04&      3.146549e-04&      1.919942e-04\\
5&      0.015 s&      2.000&      2.040816e-02&      1.010101e-01&      1.307905e-02&      6.611183e-03&      1.151447e-02&      4.356692e-03\\
6&      0.026 s&      2.000&      1.010101e-02&      1.010101e-01&      6.973412e-03&      3.521696e-03&      5.411848e-03&      2.063868e-03\\
7&      0.037 s&      2.000&      5.025126e-03&      1.010101e-01&      3.400280e-03&      1.719354e-03&      2.458380e-03&      9.513754e-04\\
8&      0.059 s&      2.000&      2.506266e-03&      1.010101e-01&      1.480623e-03&      7.594888e-04&      1.006883e-03&      4.049073e-04\\
9&      0.051 s&      2.000&      2.040816e-02&      5.025126e-02&      1.349230e-02&      6.816782e-03&      1.184267e-02&      4.438594e-03\\
10&      0.049 s&      2.000&      1.010101e-02&      5.025126e-02&      7.379377e-03&      3.720840e-03&      5.735644e-03&      2.157804e-03\\
11&      0.073 s&      2.000&      5.025126e-03&      5.025126e-02&      3.795799e-03&      1.912694e-03&      2.780234e-03&      1.050495e-03\\
12&      0.110 s&      2.000&      2.506266e-03&      5.025126e-02&      1.875565e-03&      9.455836e-04&      1.328508e-03&      5.053373e-04\\
13&      0.913 s&      2.000&      2.040816e-02&      2.506266e-02&      1.224647e-16&      nan&      nan&      nan\\
14&      0.168 s&      2.000&      1.010101e-02&      2.506266e-02&      7.478029e-03&      3.772911e-03&      5.815960e-03&      2.177077e-03\\
15&      0.182 s&      2.000&      5.025126e-03&      2.506266e-02&      3.895374e-03&      1.962594e-03&      2.859948e-03&      1.073059e-03\\
16&      0.271 s&      2.000&      2.506266e-03&      2.506266e-02&      1.974647e-03&      9.941277e-04&      1.407908e-03&      5.294525e-04\\

\end{tabular}
\end{center}

\section{Задание 3}

\subsection{Постановка задачи}

Зададим в системе уравнений, описывающей одномерное нестационарное движение вязкого баротропного газа, следующие начальные и граничные условия:

$$
\rho_0(x) = 
\begin{cases}
1{,} & 0 < x < 4.5 \\
2{,} & 4.5 < x < 5.5\\
1{,} & 5.5 < x < 10
\end{cases}
$$

$$
u_0(x) = 0{,}\quad 0 < x < 10
$$

$$
u(0{,}\, t) = 0{,}\quad 0 < t < T 
$$

$$
u(10{,}\, t) = 0{,}\quad 0 < t < T 
$$

Введем модифицированную разностную схему для решения получившейся системы уравнений в частных производных.
Обозначим $\Phi_{m}$ искуственную вязкость в узле $m$ пространственной сетки. Обозначим $\eta$ ре\-лак\-саци\-онную константу, которая регулирует влияние искуственной вязкости, значение $\eta$ положительно и подбирается экс\-пери\-мен\-тально. 

Из первого уравнения системы получаем $M - 1$ уравнение следующего вида ($1 \leq m \leq M - 1$):

$$
\hat{G}_{m-1} \cdot \left( -\frac{V_m + V_{m-1}}{4h} - \frac{\tau\eta}{2h^2}\left(\Phi_{m-1} + \Phi_{m}\right) \right)
+
$$
$$
+ \hat{V}_{m-1} \cdot \left(-\frac{1}{2h}\right)
+
$$
$$
+ \hat{G}_{m} \cdot \left(\frac{1}{\tau} + \frac{\tau\eta}{2h^2}\left(\Phi_{m-1} + 2\Phi_{m} + \Phi_{m + 1}\right)\right)
+
$$
$$
+ \hat{G}_{m+1} \cdot \left(\frac{V_{m-1} + V_m}{4h} - \frac{\tau\eta}{2h^2}\left(\Phi_{m} + \Phi_{m+1}\right)\right)
+
$$
$$
+ \hat{V}_{m+1} \cdot \frac{1}{2h} = $$
$$
= \frac{G_m}{\tau} +
  \frac{G_m \cdot \left( V_{m+1} - V_{m-1} \right)}{4h}
$$

Одно уравнение следующего вида:

$$
  \hat{G}_0 \cdot \left( \frac{1}{\tau} - \frac{V_0}{2h} + \frac{\tau\eta}{h^2}\left(\Phi_{0} + \Phi_{1}\right)\right)
-
$$
$$
- \hat{V}_0 \cdot \frac{1}{h}
+
$$
$$
+ \hat{G}_1 \cdot \left(\frac{V_1}{2h} - \frac{\tau\eta}{h^2}\left(\Phi_{0} + \Phi_{1}\right)\right)
+
$$
$$
+ \hat{V}_1 \cdot \frac{1}{h} 
= 
$$
$$ 
= \frac{G_0}{\tau} +
  \frac{G_0 \cdot \left( V_1 - V_0 \right)}{2h} +
  \frac{G_2 V_2 - 2 G_1 V_1 + G_0 V_0 +
      \left( 2 - G_0 \right) \left( V_2 - 2 V_1 + V_0 \right)}{4h}
$$

Одно уравнение следующего вида:

$$
\hat{G}_{M-1} \cdot \left(-\frac{V_{M-1}}{2h} - \frac{\tau\eta}{h^2}\left(\Phi_{M-1} + \Phi_{M}\right)\right)
-
$$
$$
- \hat{V}_{M-1} \cdot \frac{1}{h}
+
$$
$$
+ \hat{G}_{M}   \cdot \left( \frac{1}{\tau} + \frac{V_M}{2h} + \frac{\tau\eta}{h^2}\left(\Phi_{M-1} + \Phi_{M}\right)\right)
+
$$
$$
+ \hat{V}_{M}   \cdot \frac{1}{h} 
= 
$$
$$
= \frac{G_M}{\tau} +
  \frac{G_M \left( V_M - V_{M-1} \right) }{2h} +
  \frac{G_M V_M - 2 G_{M-1} V_{M-1} + G_{M-2} V_{M-2} +
      \left( 2 - G_M \right) \left( V_M - 2 V_{M-1} + V_{M-2} \right) }{4h}
$$

Из второго уравнения системы получаем $M - 1$ уравнение следующего вида ($1 \leq m \leq M - 1$):

$$
\hat{G}_{m-1} \cdot \left (-\frac{\tilde{p}'}{2h}\right)
-
$$
$$
- \hat{V}_{m-1} \cdot \left( \frac{V_{m-1} + V_m}{6h} + \frac{4\tilde\mu}{3h^2} \right)
+
$$
$$
+ \hat{V}_{m}   \cdot \left( \frac{1}{\tau} + \frac{8\tilde\mu}{3h^2}  \right)
+
$$
$$
+ \hat{G}_{m+1} \cdot \frac{\tilde{p}'}{2h} =
$$
$$
= \frac{V_m}{\tau} 
- \frac{4}{3h^2}\left(\tilde\mu - \mu e^{-G_m}\right)\left(V_{m+1} - 2V_{m} + V_{m-1}\right)
$$

Из граничных условий на $u(x, t)$ получаем еще 2 уравнения:

$$
\hat{V}_{0} = 0
$$
$$
\hat{V}_{M} = 0
$$

Таким образом, у нас теперь есть матрица системы с $2M + 2$ уравнениями и таким же количеством неизвестных.

Задаём искусственную вязкость $\Phi$ равной $V^2$.

Требуется исследовать систему при различных значениях $\mu$, $p'$, $\eta$ и привести графики решений $g(x{,}\, t)$, $v(x{,}\, t)$ при нескольких значениях времени $t$.

\subsection{Результаты}

\subsubsection{$\mu = 0.1$}
\paragraph{$p'_{\rho} = 1$}
\paragraph{$p'_{\rho} = 10$}
\paragraph{$p'_{\rho} = 100$}
\subsubsection{$\mu = 0.01$}
\paragraph{$p'_{\rho} = 1$}
\paragraph{$p'_{\rho} = 10$}
\paragraph{$p'_{\rho} = 100$}
\subsubsection{$\mu = 0.001$}
\paragraph{$p'_{\rho} = 1$}
\paragraph{$p'_{\rho} = 10$}
\paragraph{$p'_{\rho} = 100$}

\section{Задание 4}

\subsection{Постановка задачи}

Зададим в системе уравнений, описывающей одномерное нестационарное движение вязкого баротропного газа, следующие начальные и граничные условия:

$$
u_0(x) = 
\begin{cases}
0{,} & 0 < x < 4.5 \\
1{,} & 4.5 < x < 5.5\\
0{,} & 5.5 < x < 10
\end{cases}
$$

$$
\rho_0(x) = 1{,}\quad 0 < x < 10
$$

$$
u(0{,}\, t) = 0{,}\quad 0 < t < T 
$$

$$
u(10{,}\, t) = 0{,}\quad 0 < t < T 
$$

Система линейных уравнений имеет такой же вид, как в задании 3. Требования к решению те же, что в задании 3.

\subsection{Результаты}

\subsubsection{$\mu = 0.1$}
\paragraph{$p'_{\rho} = 1$}
\paragraph{$p'_{\rho} = 10$}
\paragraph{$p'_{\rho} = 100$}
\subsubsection{$\mu = 0.01$}
\paragraph{$p'_{\rho} = 1$}
\paragraph{$p'_{\rho} = 10$}
\paragraph{$p'_{\rho} = 100$}
\subsubsection{$\mu = 0.001$}
\paragraph{$p'_{\rho} = 1$}
\paragraph{$p'_{\rho} = 10$}
\paragraph{$p'_{\rho} = 100$}

\end{document}
