fill_system_non_smooth.c